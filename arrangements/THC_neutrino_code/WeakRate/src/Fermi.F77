#include "cctk.h"

#define ETA0 1.0D-3

c -----------------------------------------------------------------------
c FERMI 0
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI0(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA

        FERMI0 = ETA + LOG(1.D0 + EXP(-ETA))

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------


c -----------------------------------------------------------------------
c FERMI 1
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI1P(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL K11, K12, X

        K11     = 1.6449
        K12     = 1.6855

        X       = 1.0/ETA
        FERMI1P = (0.5 + K11*X**2)/(1 + EXP(-K12*ETA))

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI1M(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL A11, A12

        A11     = 0.2159
        A12     = 0.8857

        FERMI1M = 1.0/(1.0 + A11*EXP(A12*ETA))

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI1(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL FERMI1P, FERMI1M

        IF(ETA.GT.ETA0) THEN
            FERMI1 = ETA**2*FERMI1P(ETA)
        ELSE
            FERMI1 = EXP(ETA)*FERMI1M(ETA)
        END IF

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------


c -----------------------------------------------------------------------
c FERMI 2
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI2P(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL K21, K22, X

        K21     = 3.2899
        K22     = 1.8246

        X       = 1.0/ETA
        FERMI2P = (1.0/3.0 + K21*X**2)/(1.0 - EXP(-K22*ETA))

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI2M(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL A21, A22

        A21     = 0.1092
        A22     = 0.8908

        FERMI2M = 2.0/(1.0 + A21*EXP(A22*ETA))

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI2(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL FERMI2P, FERMI2M

        IF(ETA.GT.ETA0) THEN
            FERMI2 = ETA**3*FERMI2P(ETA)
        ELSE
            FERMI2 = EXP(ETA)*FERMI2M(ETA)
        END IF

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------


c -----------------------------------------------------------------------
c FERMI 3
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI3P(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL K31, K32, K33, X

        K31     = 4.9348
        K32     = 11.3644
        K33     = 1.9039

        X       = 1.0/ETA
        FERMI3P = (0.25 + K31*X**2 + K32*X**4)/(1.0 + EXP(-K33*ETA))

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI3M(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL A31, A32

        A31     = 0.0559
        A32     = 0.9069

        FERMI3M = 6.0/(1.0 + A31*EXP(A32*ETA))

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI3(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL FERMI3P, FERMI3M

        IF(ETA.GT.ETA0) THEN
            FERMI3 = ETA**4*FERMI3P(ETA)
        ELSE
            FERMI3 = EXP(ETA)*FERMI3M(ETA)
        END IF

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------


c -----------------------------------------------------------------------
c FERMI 4
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI4P(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL K41, K42, K43, X

        K41     = 6.5797
        K42     = 45.4576
        K43     = 1.9484

        X       = 1.0/ETA
        FERMI4P = (0.2 + K41*X**2 + K42*X**4)/(1.0 - EXP(-K43*ETA))

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI4M(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL A41, A42

        A41     = 0.0287
        A42     = 0.9257

        FERMI4M = 24.0/(1.0 + A41*EXP(A42*ETA))

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI4(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL FERMI4P, FERMI4M

        IF(ETA.GT.ETA0) THEN
            FERMI4 = ETA**5*FERMI4P(ETA)
        ELSE
            FERMI4 = EXP(ETA)*FERMI4M(ETA)
        END IF

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------


c -----------------------------------------------------------------------
c FERMI 5
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI5P(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL K51, K52, K53, K54, X

        K51     = 8.2247
        K52     = 113.6439
        K53     = 236.5323
        K54     = 1.9727

        X       = 1.0/ETA
        FERMI5P = (1.0/6.0 + K51*X**2 + K52*X**4 + K53*X**6)/
     &              (1.0 + EXP(-K54*ETA))

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI5M(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL A51, A52

        A51     = 0.0147
        A52     = 0.9431

        FERMI5M = 120.0/(1.0 + A51*EXP(A52*ETA))

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI5(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL FERMI5P, FERMI5M

        IF(ETA.GT.ETA0) THEN
            FERMI5 = ETA**6*FERMI5P(ETA)
        ELSE
            FERMI5 = EXP(ETA)*FERMI5M(ETA)
        END IF

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------


c -----------------------------------------------------------------------
c FERMI Ratios
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI4O2(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL FERMI4P, FERMI4M, FERMI2P, FERMI2M

        IF(ETA.GT.ETA0) THEN
            FERMI4O2 = ETA**2*FERMI4P(ETA)/FERMI2P(ETA)
        ELSE
            FERMI4O2 = FERMI4M(ETA)/FERMI2M(ETA)
        END IF

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI4O3(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL FERMI4P, FERMI4M, FERMI3P, FERMI3M

        IF(ETA.GT.ETA0) THEN
            FERMI4O3 = ETA*FERMI4P(ETA)/FERMI3P(ETA)
        ELSE
            FERMI4O3 = FERMI4M(ETA)/FERMI3M(ETA)
        END IF

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI5O3(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL FERMI5P, FERMI5M, FERMI3P, FERMI3M

        IF(ETA.GT.ETA0) THEN
            FERMI5O3 = ETA**2*FERMI5P(ETA)/FERMI3P(ETA)
        ELSE
            FERMI5O3 = FERMI5M(ETA)/FERMI3M(ETA)
        END IF

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------

c -----------------------------------------------------------------------
        CCTK_REAL FUNCTION FERMI5O4(ETA)
c -----------------------------------------------------------------------
        IMPLICIT NONE
        CCTK_REAL ETA
        CCTK_REAL FERMI5P, FERMI5M, FERMI4P, FERMI4M

        IF(ETA.GT.ETA0) THEN
            FERMI5O4 = ETA*FERMI5P(ETA)/FERMI4P(ETA)
        ELSE
            FERMI5O4 = FERMI5M(ETA)/FERMI4M(ETA)
        END IF

        RETURN
        END FUNCTION
c -----------------------------------------------------------------------
